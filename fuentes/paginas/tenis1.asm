turbo	= $b3
B00600 = $05CC  ;TIMER 600 BPS
B00800 = $0457  ;TIMER 800 BPS
	org $D301
	.BY $FE
	org $BC20
	.BY 1
	.WO NEWDL
VOLVERE
	org  $BB00
NEWDL
	.BY 112,112,66
	.WO LINE0
	.BY 48,1
	.WO VOLVERE
LINE0
	.SB +128,"  CON "
	.sb "S"
	.sb +128,"ubrutina    C-"
C?
	.SB +128,"000 SIN "
	.sb "R"
	.sb +128,"eset  "
MENSAJE.TV
		.SB +128,"    "
CON 	.SB +128,"CON"
SIN 	.SB +128,"SIN"
SECTOR	.BY "000",$9B
FACTOR	.BY "2.3",$9B
	org $8000
MENSAJE.NTSC
	.SB +128,"NTSC"
MENSAJE.PAL
	.SB +128,"PAL "
EORBYTE 	.BY $00
BYTEMULA	.BY $00
CANTR 		.WO $4000
CANTW 		.WO $4000
LASTCANT 	.WO $4000
DESDE	= $0C
HASTA = $0E
FRO =   $D4
RAM =   $CB
ROM =   $CD
FEOR .BYTE 0
FEOF .BYTE 0
BANCO .BYTE 0
GUARDABANCO .BYTE 0
SUB
	JSR USERSUB+Z
SINRES
	JMP $0392
CONRES
	JMP ($FFFC)
;SET =   PROGRAMA-RAMPROG
STRING
	.BY "D1:"
;0560 NOMBRE
;0570     org  *+20
nombre
:20	.sb " "
PABONITO
	.SB "000  BLOQUES A GRABAR "
GRABAMULA
	LDX #$08
	LDY PALNTS
	BEQ GRABAMULA.1
	DEX
GRABAMULA.1
	JSR GRABAMULA.WAIT
	LDA #139
	STA $D20F
	LDX #8
;   STA BYTEMULA
	LDY PALNTS
	BEQ GRABAMULA.2
	DEX
GRABAMULA.2
	JSR GRABAMULA.WAIT
	LDA #11
	STA $D20F
	LDX #16
	LDY PALNTS
;   JSR LINEA10?
	BEQ GRABAMULA.3
	LDX #13
GRABAMULA.3
	JSR GRABAMULA.WAIT
	LDA #139
	STA $D20F
	LDX #47
	LDY PALNTS
	BEQ GRABAMULA.4
;   LDA #163
	LDX #39
GRABAMULA.4
	JSR GRABAMULA.WAIT
	LDA #11
	STA $D20F
	RTS
;
;
;
;   STA $D20F
;   JSR LINEA10?
;   LDX #$07
LOOPMULA
;   LDA #163
;   ASL BYTEMULA
;   BCC MULA0
;   LDA #35
MULA0
;   STA $D20F
;   JSR LINEA10?
;   DEX
;   BPL LOOPMULA
;   LDA #35
;   STA $D20F
;   RTS
GRABAMULA.WAIT
	JSR LINEA10?
	DEX
	BNE GRABAMULA.WAIT
	RTS
;
; ESPERA X BARRIDOS
;
;
LINEA10?
	LDA $D40B
	CMP #10
	BNE LINEA10?
	STA $D40A
	STA $D40A
	RTS
;BAUD.600
;	LDA # <B00600
;	JSR BAUD.M1
;	LDA # >B00600
;	JMP BAUD.M2
;BAUD.800
;	LDA # <B00800
;	JSR BAUD.M1
;	LDA # >B00800
;BAUD.M2
;	STA $EBA8
;	STA $FD46
;	STA $FCE1
;	RTS
;BAUD.M1
;	STA $EBA3
;	STA $FD41
;	STA $FCDC
;	RTS
EOREO
	LDY #$00
	LDA (DESDE),Y
	EOR EORBYTE
	STA (DESDE),Y
	INC DESDE
	BNE NOINCDESDE1
	INC DESDE+1
NOINCDESDE1
	LDA DESDE+1
	CMP HASTA+1
	BNE EOREO
	LDA DESDE
	CMP HASTA
	BNE EOREO
	RTS
BANQUEO
	ORA #$08
	CLC
	ROL A
	ROL A
	PHA
	LDA #$C3
	AND $D301
	STA $D301
	PLA
	ORA $D301
	AND #$FE
	STA $D301
	RTS
SUBCLOSE
;	close1
	ldx #$10
	lda #$0c
	sta $0342,x
	jsr $e456
	RTS
SUBOPEN
;	OPEN  1,4,128,STRING
	ldx #$10
	lda #$03
	sta $0342,x
	lda #$04
	sta $034a,x
	lda #$80
	sta $034b,x
	lda #$1d
	sta $0344,x
	lda #$80
	sta $0345,x
	jsr $e456
	BPL OPENOK
	JSR SUBCLOSE
	JSR SUBDIRECTORIO
	JMP SUBOPEN
OPENOK
	RTS
SUBBGET
;	BGET  1,$4000,CANTR
	ldx #$10
	lda #$07
	sta $0342,x
	lda #$00
	sta $0344,x
	lda #$40
	sta $0345,x
	lda cantr
	sta $0348,x
	lda cantr+1
	sta $0349,x
	jsr $e456	
	RTS
SUBREAD
	JSR SUBOPEN
	LDA #$04
	STA BANCO
LOOPBANCOS
	DEC BANCO
	LDA BANCO
	JSR BANQUEO
	JSR SUBBGET
	LDA 856	;$0358
	CMP CANTR
	BNE FINCARGA
	LDA 857
	CMP CANTR+1
	BEQ LOOPBANCOS
FINCARGA
	LDA BANCO
	STA GUARDABANCO
	LDA 856
	STA LASTCANT
	STA FRO
	LDA 857
	STA LASTCANT+1
	STA FRO+1
	LDX #$02
	LDA #$90	;'0-32
VUELVEA0
	STA PABONITO,X
	LDY FEOR
	BEQ NOEORFF
	EOR #$FF
NOEORFF
	STA TENMEBLK,X
	DEX
	BPL VUELVEA0
	LDX #$03
CALCULOASC
	CPX GUARDABANCO
	BEQ NOFINCALCULO
	CLC
	LDA FRO
	ADC CANTR
	STA FRO
	LDA FRO+1
	ADC CANTR+1
	STA FRO+1
	DEX
	BPL CALCULOASC
	NOFINCALCULO
	LDY #$01
	LDA FRO
	AND #$7F
	BEQ FINCALCULO
	INY
FINCALCULO
	LDX #$06
LOOPFINCALCULO
	LSR FRO+1
	ROR FRO
	DEX
	BPL LOOPFINCALCULO
	CLC
	TYA
	ADC FRO
	STA FRO
	LDA FRO+1
	ADC #$00
	STA FRO+1
	JSR $D9AA
	JSR $D8E6
	LDY #$00
LOOPPOSITIVO
	LDA ($F3),Y
	BMI ESNEGATIVO
	INY
	BPL LOOPPOSITIVO
ESNEGATIVO
	SEC
	SBC #32
	STA PABONITO+2
	LDX FEOR
	BEQ NOEORFF1
	EOR #$FF
NOEORFF1
	STA TENMEBLK+2
	DEY
	BMI NOQUEDANMAS
	LDA ($F3),Y
	ORA #$80
	SEC
	SBC #32
	STA PABONITO+1
	LDX FEOR
	BEQ NOEORFF2
	EOR #$FF
NOEORFF2
	STA TENMEBLK+1
	DEY
	BMI NOQUEDANMAS
	LDA ($F3),Y
	EOR #$80
	SEC
	SBC #32
	STA PABONITO
	LDX FEOR
	BEQ NOEORFF3
	EOR #$FF
NOEORFF3
	STA TENMEBLK
NOQUEDANMAS
	JMP SUBCLOSE
SUBDIRECTORIO
	LDA #$7d	;'}
	JSR PRINTBYTE
	;OPEN  1,6,0,"D:*.*"
	LDX #$10
	LDA #$03
	STA $0342,X
	LDA #$06
	STA $034A,X
	LDA #$00
	STA $034B,X
ALL
	.BY 'D:*.*'		;REPARAR
	.BY 0			;
?SUBDIRECTORIO
	LDA #<ALL
	STA $0344,X
	LDA #>ALL
	STA $0345,X
	JSR $E456
DIRECTORIO
	ldx #$10
	lda #$05
	sta $0342,x
	lda #$20
	sta $0344,x
	lda #$80
	sta $0345,x
	lda #$FF
	sta $0348,x
	lda #$00
	sta $0349,x
	jsr $e456
;	INPUT  1,NOMBRE
	BMI FINDIRECTORIO
;	PRINT  0,NOMBRE
	ldx #$00
	lda #$09
	sta $0342,x
	lda #$20
	sta $0344,x
	lda #$80
	sta $0345,x
	lda #$FF
	sta $0348,x
	lda #$00
	sta $0349,x
	jsr $e456
	JMP DIRECTORIO
FINDIRECTORIO
	JSR SUBCLOSE
	LDA #$9B
	JSR PRINTBYTE
	LDA #$9B
	JSR PRINTBYTE
;	PRINT  0,"  ELIJA FILE A GRABAR!"
PELIJA
	.BY "  ELIJA FILE A GRABAR!",$9B
PRINT
	ldx #$00
	lda #$09
	sta $0342,x
	lda #<PELIJA
	sta $0344,x
	lda #>PELIJA
	sta $0345,x
	lda #$17
	sta $0348,x
	lda #$00
	sta $0349,x
	jsr $e456
	LDA #$FF
	JSR BANQUEO
	LDX #19
	LDA #$00
SINNOMBRE
	STA NOMBRE,X
	DEX
	BPL SINNOMBRE
TOMEFILE
	LDA $58
	STA $00
	LDA $59
	STA $01
INVIERTA
	JSR INVERSO
QUEAPRETO?
	LDA #$FF
	STA 764
WTECLA
	LDA 764
	CMP #$FF
	BEQ WTECLA
	CMP #28
	BNE NOOTRO
	RTS
NOOTRO
	CMP #62
	BNE NOCSUB
	LDX #$00
	LDY #$02
	LDA LINE0,Y
	CMP #$A3	;'C-32
	BEQ PONSINSUB
PONCONSUB
	LDA CON,X
	STA LINE0,Y
	LDA SUB,X
	BIT FEOR
	BEQ NOEOR29A
	EOR #$29
NOEOR29A
	STA CONSUBRUTINA,X
	INY
	INX
	CPX #$03
	BNE PONCONSUB
	BEQ QUEAPRETO?
PONSINSUB
	LDA SIN,X
	STA LINE0,Y
	LDA #$EA
	BIT FEOR
	BEQ NOEOR29B
	EOR #$29
NOEOR29B
	STA CONSUBRUTINA,X
	INY
	INX
	CPX #$03
	BNE PONSINSUB
	BEQ QUEAPRETO?
NOCSUB
	CMP #40
	BNE NOCRES
	LDX #$00
;   LDY #28
	LDY #25
	LDA LINE0,Y
	CMP #$A3	;'C-32
	BEQ PONSINRES
PONCONRES
	LDA CON,X
	STA LINE0,Y
	LDA CONRES,X
	BIT FEOR
	BEQ NOEOR29C
	EOR #$29
NOEOR29C
	STA SINRESET,X
	INY
	INX
	CPX #$03
	BNE PONCONRES
	JMP QUEAPRETO?
PONSINRES
	LDA SIN,X
	STA LINE0,Y
	LDA SINRES,X
	BIT FEOR
	BEQ NOEOR29D
	EOR #$29
NOEOR29D
	STA SINRESET,X
	INY
	INX
	CPX #$03
	BNE PONSINRES
	JMP QUEAPRETO?
NOCRES
	CMP #15
	BNE NOUPALE
	JSR INVERSO
	CLC
	LDA $00
	ADC #40
	STA $00
	LDA $01
	ADC #$00
	STA $01
	LDY #$03
	LDA ($00),Y
	BEQ NOTOMEFIL
	JMP TOMEFILE
NOTOMEFIL
	JMP INVIERTA
NOUPALE
	CMP #14
	BNE NOBAJALE
	JSR INVERSO
	LDA $00
	CMP $58
	BNE BAJE
	LDA $01
	CMP $59
	BNE BAJE
	JMP TOMEFILE
BAJE
	SEC
	LDA $00
	SBC #40
	STA $00
	LDA $01
	SBC #$00
	STA $01
	JMP INVIERTA
NOBAJALE
	CMP #12
	BEQ ELCOK
	JMP QUEAPRETO?
ELCOK
	JSR INVERSO
	LDY #$04
	LDX #$00
ESTAFILE
	LDA ($00),Y
	BEQ PUNTO
	CLC
	ADC #$20
	STA NOMBRE,X
	INX
	INY
	CPY #$0C
	BNE ESTAFILE
PUNTO
	LDY #$0C
	LDA #$2e	;'.
	STA NOMBRE,X
	INX
LOPUNTO
	LDA ($00),Y
	BEQ FINPUNTO
	CLC
	ADC #$20
	STA NOMBRE,X
	INX
	INY
	CPY #$0F
	BNE LOPUNTO
FINPUNTO
	RTS
INVERSO
	LDY #$0F
LOINVIERTO
	LDA ($00),Y
	EOR #$80
	STA ($00),Y
	DEY
	CPY #$03
	BNE LOINVIERTO
	LDY #$02
	LDA #$90	;'0-32
BORREC
	STA C?,Y
	DEY
	BPL BORREC
	LDY #$10
	LDX #$00
TOMENUM
	LDA ($00),Y
	CLC
	ADC #$20
	STA SECTOR,X
	INY
	INX
	CPX #$03
	BNE TOMENUM
	LDA # <FACTOR
	STA $F3
	LDA # >FACTOR
	STA $F4
	LDA #$00
	STA $F2
	JSR $D800
	BCC NOC1000
	JMP C1000?
NOC1000
	JSR $DDB6
	LDA # <SECTOR
	STA $F3
	LDA # >SECTOR
	STA $F4
	LDA #$00
	STA $F2
	SR $D800
	BCS C1000?
	JSR $DADB
	BCS C1000?
	JSR $DDB6
	LDA #87
	STA $D4
	LDA #$00
	STA $D5
	JSR $D9AA
	JSR $DA66
	JSR $DDB6
	LDA #30
	STA $D4
	LDA #$00
	STA $D5
	JSR $D9AA
	LDY #$05
FR1FR0
	LDA $D4,Y
	PHA
	LDA $E0,Y
	STA $D4,Y
	PLA
	STA $E0,Y
	DEY
	BPL FR1FR0
	JSR $DB28
	BCS C1000?
	JSR $D9D2
	BCS C1000?
	INC $D4
	BNE NOINCD5
	INC $D5
NOINCD5
	JSR $D9AA
	JSR $D8E6
	LDY #$00
ESASC?
	LDA ($F3),Y
	BMI FINASC
	INY
	BNE ESASC?
FINASC
	LDA ($F3),Y
	SEC
	SBC #32
	STA C?+2
	DEY
	BMI C1000?
	LDA ($F3),Y
	SEC
	SBC #32
	ORA #$80
	STA C?+1
	DEY
	BMI C1000?
	LDA ($F3),Y
	SEC
	SBC #32
	ORA #$80
	STA C?
C1000?
	RTS
NO.IRG
	LDX #$04
	LDA #$EA    ;NOP
NO.IRG.LOOP
	STA $EBC6,X
	DEX
	BPL NO.IRG.LOOP
	RTS
SI.IRG
	LDX #$04
SI.IRG.LOOP
	LDA SI.IRG.TABLA,X
	STA $EBC6,X
	DEX
	BPL SI.IRG.LOOP
	RTS
SI.IRG.TABLA
	.BYTE $AD,$17,$03,$D0,$FB
IRG.100
	LDA #$06
	STA $EE11
	STA $EE15
	LDA #$05
	STA $EE12
	STA $EE16
	RTS
INICIOPROGRAMA
	LDA #$00
	STA FEOR
	LDA #$FE
	STA $D301
	STA $0244
	LDA #112
	STA 16
	STA 53774
	LDA #$03
	STA $FE8D
	LDA #$02
	STA $FE8E
	LDA #$0C
	STA $FE8F
	LDA #$8A
	STA $FE90
; QUEDAMOS CON IRG DE 14 SEGUNDOS
;   LDA #$EA
;   STA 64881
;   STA 64882
	JSR IRG.100
;
; IRG CORTO DE 100 MILISEGUNDOS
;
	LDA #$60
	STA 65020   ; NO BEEP BEEP! $fdfc
	LDA #$34
	STA $FDD7   ; NO APAQUE MOTOR!
	LDA #$00
	STA 710
	LDA #1
	STA 752
	JSR DETECTA.PAL ;A DETECTAR PAL!
	LDX #$03
INICIOPROGRAMA.LOOP
	LDA MENSAJE.NTSC,X
	LDY PALNTS
	BEQ INICIOPROGRAMA.LOOP2
	LDA MENSAJE.PAL,X
INICIOPROGRAMA.LOOP2
	STA MENSAJE.TV,X
	DEX
	BPL INICIOPROGRAMA.LOOP
;   LDX #4
;   LDA #$EA
;LOOPIRG1
;   STA $EBC6,X
;   DEX
;   BPL LOOPIRG1
	JSR NO.IRG
	LDA #TURBO
	STA $CF
CAMBIADISCO
	jmp print2
;	PRINT  0,"}  INGRESE DISCO CON FILE A GRABAR"
pcambiadisco
	.by $7d,"  INGRESE DISCO CON FILE A GRABAR",$9b
print2
	ldx #$00
	lda #$09
	sta $0342,x
	lda #<pcambiadisco
	sta $0344,x
	lda #>pcambiadisco
	sta $0345,x
	lda #$23
	sta $0348,x
	lda #$00
	sta $0349,x
	jsr $e456
	LDA #$FF
	STA 764
	JSR GETBYTE
	JSR SUBDIRECTORIO
	JSR SUBREAD
OTRACOPIA
;	PRINT  0,"}   RETURN PARA COMENZAR GRABACION"
	jmp print3
potracopia
	.by $7d,"   RETURN PARA COMENZAR GRABACION",$9b
print3	
	ldx #$00
	lda #$09
	sta $0342,x
	lda #<potracopia
	sta $0344,x
	lda #>potracopia
	sta $0345,x
	lda #$23
	sta $0348,x
	lda #$00
	sta $0349,x
	jsr $e456
	LDY #130
	LDX #0
LOOPBONITO
	LDA PABONITO,X
	STA ($58),Y
	INY
	INX
	CPX #21
	BNE LOOPBONITO
	LDY #216
	LDX #$00
BELLO
	LDA NOMBRE,X
	SEC
	SBC #$20
	BMI FINBELISIMO
	STA ($58),Y
	INY
	INX
	BNE BELLO
FINBELISIMO
	LDA #$FF
	STA 764
	JSR GETBYTE
	CMP #$1b	;'?
	BNE NOCAMBIADISCO
	JMP CAMBIADISCO
NOCAMBIADISCO
	LDA #$7d	;'}
	JSR $F2B0
	LDY #215
	LDX #$00
NUMEROSCREEN
	LDA PABONITO,X
	STA ($58),Y
	INY
	INX
	CPX #$03
	BNE NUMEROSCREEN
	INY
NOMBRESCREEN
	LDA STRING,X
	SEC
	SBC #$20
	BMI ENDNAME
	STA ($58),Y
	INX
	INY
	BNE NOMBRESCREEN
ENDNAME
	LDX #$08
NUEVEBLKS
	LDY #217
NUEVEBLKS1
	LDA ($58),Y
	CLC
	ADC #$01
	CMP #$9a	;'9-31
	BEQ NUEVE9
	STA ($58),Y
	DEX
	BPL NUEVEBLKS
	BMI FINNUEVE
NUEVE9
	LDA #$90	;'0-32
	STA ($58),Y
	DEY
	CPY #214
	BNE NUEVEBLKS1
FINNUEVE
	LDA #$FF
	JSR BANQUEO
	LDA #$D0
	STA $FD71
	LDA #$F7
	STA $FD72   ; HABILITA LEAD
	JSR GRABABLKUNO
	LDA #$EA
	STA $FD71
	STA $FD72   ; DESHABILITA LEAD
	LDA #$00-210
	LDX PALNTS
	BEQ BLKUNO.NTSC
	LDA #$00-175
BLKUNO.NTSC
	STA 20
BLKUNO.LOOP
	LDA 20
	BNE BLKUNO.LOOP
	LDA #$00
	STA 20
	STA $0480
	STA $0481
	STA FEOF
	LDA # <FIN-GAMEA
	STA CANTW
	LDA # >FIN-GAMEA
	STA CANTW+1
	JSR WRITETOCASSETTE
;   LDA #$00-8
	LDA #$00-156
	LDX PALNTS
	BEQ BLK2.NTSC
	LDA #$00-130
BLK2.NTSC
	STA 20
W1SEG
	LDA 20
	BNE W1SEG
	LDA #$10
	STA 20
	LDA #1
	STA FEOF
	LDA CANTR
	STA CANTW
	LDA CANTR+1
	STA CANTW+1
	LDA #$04
	STA BANCO
	JSR WRITETOCASSETTE
;   LDA #$00-8
	LDA #$00-52
	LDY PALNTS
	BEQ LOPLEAD1.NTSC
	LDA #$00-43
LOPLEAD1.NTSC
	STA 20
LOPLEAD1
	LDA 20
	BNE LOPLEAD1
	LDY #$02
SAVEC0LENTO
	TYA
	PHA
	LDA #$C0
	JSR GRABAMULA
	PLA
	TAY
	DEY
	BPL SAVEC0LENTO
	LDA #10
	STA 20
FINAL.LOOP
	LDA 20
	BNE FINAL.LOOP
; LE DAMOS TIEMPO PARA QUE CIERRE EL ARCHIVO.
;
	LDA #$3C
	STA $D302
	JMP OTRACOPIA
WRITETOCASSETTE
	JSR $FD34
LEADERTIME
	LDA 20
	CMP #$20
	BCC LEADERTIME
	LDA FEOF
	BEQ NOLASTBANCO
GRABANDOP02
	DEC BANCO
	LDA BANCO
	PHA
	JSR BANQUEO
	PLA
	CMP GUARDABANCO
	BNE NOLASTBANCO
	LDA LASTCANT
	STA CANTW
	LDA LASTCANT+1
	STA CANTW+1
	LDA #$FF
	STA FEOF
NOLASTBANCO
	LDA # <$4000
	STA $00
	LDA # >$4000
	STA $01
	LDA #$00
	STA $02
	STA $03
WRITECASSETTE
	LDA $D01F
	CMP #$03
	BNE SIGAGRBANDO
	JMP $FDD6
SIGAGRBANDO
	JSR SI.IRG
	LDY #$00
	LDA ($00),Y
	JSR $FDB4
	BNE NONUEVOBLK
	JSR NO.IRG
	LDY #135
BUFSCREEN
	LDA $03FF,Y
	STA ($58),Y
	DEY
	BNE BUFSCREEN
	LDY #217
	LDX #$02
DECBELLO
	LDA ($58),Y
	SEC
	SBC #$01
	CMP #$8f	;'0-33
	BEQ NINEBELLO
	STA ($58),Y
	BNE FINBELLO
NINEBELLO
	LDA #$99	;'9-32
	STA ($58),Y
	DEY
	DEX
	BPL DECBELLO
FINBELLO
	INC $0480
	BNE NONUEVOBLK
	INC $0481
NONUEVOBLK
	INC $00
	BNE NOINCHIBIS
	INC $01
NOINCHIBIS
	INC $02
	BNE NOINCHIS
	INC $03
NOINCHIS
	LDA $03
	CMP CANTW+1
	BNE WRITECASSETTE
	LDA $02
	CMP CANTW
	BNE WRITECASSETTE
	LDA FEOF
	BEQ FINP01
	BMI FINP01
	JMP GRABANDOP02
FINP01
	LDX $3D
	BEQ TERMINOWRITE
	LDY #$7F
POKEANDOESPERO
	STY $D40A
	DEY
	BNE POKEANDOESPERO
	STX $047F
	LDA #$FA
	JSR $FE7C
TERMINOWRITE
	INC $0480
	BNE NOINC481
	INC $0481
NOINC481
	LDA FEOF
	BNE SIEOF
	JMP $FDD6
SIEOF
	LDX #$7F
	LDA #$00
FILLBUFFER
	STA $0400,X
	STA $D40A
	DEX
	BPL FILLBUFFER
	LDA #$FE
	JSR $FE7C
	JMP $FDD6
;	*=  $02E0
;	.WORD INICIOPROGRAMA
	run INICIOPROGRAMA
EORLEN 	= FINFIRST-AEOREAR+1
ADR 	=   $0380-3
RESTABYTE = $03FF
DIF 	=   $A000-ADR
;	*=  ADR+DIF
	org ADR+DIF
AGRABAR
	.BY $55,$55
	.BY $FA
BLKUNO
	.BY $00
	.BY $01
	.WO $0380	;*-2-DIF
	.WO $E456
	LDX #EORLEN
	TXS
EORLOOP
	SEC
	LDA AEOREAR-DIF,X
	TAY
	SBC RESTABYTE
	STY RESTABYTE
	PHA
	DEX
	BPL EORLOOP
	RTS
AEOREAR
	.BY $01
	.BY $01
	LDX #$01
	STX $0244
	DEX
	STX $022F
	STX $D400
	STX $41
RELOS
	LDX #$00-20
	STX 20
ESPERASINCRO
	LDA $D20F
	AND #$10
	BNE RELOS
	LDX 20
	BNE ESPERASINCRO
TERMINA0
	LDA $D20F
	AND #$10
	BEQ TERMINA0
	LDX #$0B
TRANSFER
	LDA DATIX1-DIF,X
	STA $0300,X
	DEX
	BPL TRANSFER
	JSR $E459
	LDX #$FF
	TXS
	JMP ($0304)
FINFIRST
	PLA
	RTI
DATIX1
	.BY $60
	.BY $00
	.BY $52
	.BY $40
	.WO BLKFALSO
	.BY $23
	.BY $00
	.WO FINBLKFALSO-BLKFALSO
	.BY $00
	.BY $80
;	*=  $03EA+DIF
	ORG $03EA+DIF
	.BY $00
;	*=  AGRABAR+$84
	ORG AGRABAR+$84
GRABABLKUNO
	LDA FEOR
	BEQ EORNOLISTO
	JMP EORLISTO
EORNOLISTO
	LDA # <EORBLOCK
	STA DESDE
	LDA # >EORBLOCK
	STA DESDE+1
	LDA # <FINBLKFALSO
	STA HASTA
	LDA # >FINBLKFALSO
	STA HASTA+1
	LDA #$46
	STA EORBYTE
	JSR EOREO
	LDA # <EORBLOCK1
	STA DESDE
	LDA # >EORBLOCK1
	STA DESDE+1
	LDA # <FINBLKDOS
	STA HASTA
	LDA # >FINBLKDOS
	STA HASTA+1
	LDA #$FF
	STA EORBYTE
	JSR EOREO
	LDA # <GAME1A
	STA DESDE
	LDA # >GAME1A
	STA DESDE+1
	LDA # <FIN
	STA HASTA
	LDA # >FIN
	STA HASTA+1
	LDA #$29
	STA EORBYTE
	JSR EOREO
	LDX #EORLEN
	STX FEOR
EORLOOP1
	CLC
	LDA AEOREAR,X
	ADC SUMABYTE
	STA SUMABYTE
	STA AEOREAR,X
	DEX
	BPL EORLOOP1
	LDA #0
	STA CHKSUM
	LDX #$82
	LDA #$01
	STA AGRABAR,X
ADCHKSUM
	LDA AGRABAR,X
	CLC
	ADC CHKSUM
	ADC #0
	STA CHKSUM
	DEX
	CMP #$FF
	BNE ADCHKSUM
	LDX #$83
	STA BLKUNO,X
EORLISTO
	JSR BAUD.600
;	JSR $FD34   ; GRABA LEADER
	CLC
	LDA #100
	LDX PALNTS
	BEQ LEADER.NTSC
	LDA #83
LEADER.NTSC
	ADC 20
;   LDA 20
;   ADC #100
WLEADERTIME
	CMP 20
	BNE WLEADERTIME
	LDX #$0B
?LOOP
	LDA DATA1,X
	STA $0300,X
	DEX
	BPL ?LOOP
	JSR $E459   ; GRABA PRIMER BLOQUE
;	JSR BAUD.800
	CLC
	LDA #$0F    ; 0.25 SEC NTSC
	LDX PALNTS
	BEQ PRIMERBLOQUE.NTSC
	LDA #$0C    ; 0.25 SEC PAL
PRIMERBLOQUE.NTSC
	ADC 20
;   LDA 20
;   ADC #$0F
ESPERIX
	CMP 20
	BNE ESPERIX
	JSR GRABATRAMPA
	CLC
	LDA 20
	ADC #$0F
WFALSO
	CMP 20
	BNE WFALSO
	LDX #$0B
SAVEFALSO
	LDA DATAFALSA,X
	STA $0300,X
	DEX
	BPL SAVEFALSO
	JSR $E459
	CLC
	LDA #40
	LDX PALNTS
	BEQ WFORIRGTIME.NTSC
	LDA #33
WFORIRGTIME.NTSC
	ADC 20
;   LDA 20
;   ADC #6
WFORIRGTIME
	CMP 20
	BNE WFORIRGTIME
	LDX #$0B
?LOOP1
	LDA DATA2,X
	STA $0300,X
	DEX
	BPL ?LOOP1
	JSR $E459
;   LDA #60
	LDA #$34
	STA 54018
	RTS
CHKSUM
	.BY 0
DATA1
	.BY $60,0,$57,$80
	.WO AGRABAR
	.BY $23,0
	.WO $83
	.BY 0,$80
DATA2
	.BY $60,0,$57,$80
	.WO BLKDOS
	.BY $23,0
	.WO FINBLKDOS-BLKDOS
	.BY 0
	.BY $80
DATAFALSA
	.BY $60,0,$57,$80
	.WO BLKFALSO
	.BY $23,0
	.WO FINBLKFALSO-BLKFALSO
	.BY 0,$80
SUMABYTE
	.BY $FA
	org $7000-4
TRAMPA
	.BY $55,$55,$FC
	.BY $01
	.WO $7000
	.WO $E456
	LDA #$00
	LDY #$02
	STA ($58),Y
	STA 710
	STA $41
	LDX #$10
	LDA #$03
	STA $02EC,X
	STA $0342,X
	LDA #$04
	STA $034A,X
	LDA #$80
	STA $034B,X
	LDA # <$C431
	STA $0344,X
	LDA # >$C431
	STA $0345,X
	JSR $E456
	LDA #$00
	STA $0344,X
	STA $0348,X
	LDA #$07
	STA $0345,X
	LDA #$06
	STA $0349,X
	LDA #$07
	STA $0342,X
	JSR $E456
	DEY
LOOPTRAMPA
	LDA $0700,Y
	EOR $0800,Y
	STA $0700,X
	DEY
	BNE LOOPTRAMPA
	LDA # <DLTRAMPA+2
	STA 560
	LDA # >DLTRAMPA+2
	STA 561
	JMP $0700
DLTRAMPA
	.BY 112,112,112,64+6
	.WO TEXTOTRAMPA+2
	.BY 65

	.SB "    turbo SOFTWARE     "
;	*=  $707F
	org $707F
CHEQUEO
	.BY 0
FCHK
	.BY 0
GRABATRAMPA
	LDA FCHK
	BNE CHEQUEOK
	INC FCHK
	LDA #$00
	STA CHEQUEO
	LDX #$82
CHKTRAMPA
	LDA TRAMPA,X
	CLC
	ADC #$00
	ADC CHEQUEO
	STA CHEQUEO
	DEX
	CPX #$FF
	BNE CHKTRAMPA
	LDX #$83
	STA TRAMPA,X
CHEQUEOK
	LDX #$0B
LOOPTRAMPIX
	LDA DATATRAMPA,X
	STA $0300,X
	DEX
	BPL LOOPTRAMPIX
	JSR $E459
	CLC
	LDA #$0F
	LDX PALNTS
	BEQ TRAMPA.NTSC
	LDA #$0C
TRAMPA.NTSC
	ADC 20
; 	LDA 20
; 	ADC #$0F
ESPERATRAMPA
	CMP 20
	BNE ESPERATRAMPA
	LDA #$83
	STA $FE48   ; BLOQUE DE 131 BYTES (ESTANDAR ATARI)
	JSR $FDEA   ; GRABA EOF
	LDA #133
	STA $FE48   ; AGREGA 2 BYTES BLOQUE (PARA AGREGAR CONTADOR)
; 	LDA #163
	LDA #139
	STA $D20F
	LDX #$28    ; VALOR ORIGINAL: 4
	LDY PALNTS
	BEQ LOOPLINEA.NTSC
	LDX #$21
LOOPLINEA.NTSC
	LDY $D40B
LOOPLINEA
	CPY $D40B
	BEQ LOOPLINEA
WLINE
	CPY $D40B
	BNE WLINE
	DEX
	BPL LOOPLINEA.NTSC
; 	LDA #35
	LDA #11
	STA $D20F
	RTS
DATATRAMPA
	.BY $60,$00,$57,$80
	.WO TRAMPA
	.BY $23,$00
	.WO $83
	.BY $00,$80
;	*=  $2000
	org $2000
BLKFALSO
	.BY $55,$55
	TYA
	BPL BLOCKOK
	LDA #34
	STA 559
	JSR $EDC7
	JMP $C8FC
BLOCKOK
	LDA EORBLOCK
	EOR #$46
	STA EORBLOCK
	INC BLOCKOK+6
	INC BLOCKOK+1
	BNE NOINCBLOCK2
	INC BLOCKOK+7
	INC BLOCKOK+2
NOINCBLOCK2
	LDA BLOCKOK+2
	CMP # >FINBLKFALSO
	BNE BLOCKOK
	LDA BLOCKOK+1
	CMP # <FINBLKFALSO
	BNE BLOCKOK
EORBLOCK
	LDA #$00
	STA 710
	LDA #$FF
	STA $D301
	JSR ROMARAM
	LDA #34
	STA 559
	STA $D400
	LDA # <DL
	STA 560
	LDA # >DL
	STA 561
LINEAPOSITIVA
	LDY $D40B
	BMI LINEAPOSITIVA
	LDA #$FF
	STA $50
	LDA # <MUS
	STA $0222
	LDA # >MUS
	STA $0223
	LDX #$0B
CARGALASTBLOCK
	LDA DATALAST,X
	STA $0300,X
	DEX
	BPL CARGALASTBLOCK
	LDA #$FF-2
	STA 20
WVBI
	LDA 20
	BNE WVBI
	LDY #19
CHECKTURBO
	CLC
	LDA DATA,Y
	ADC BITLOCO+1
	ADC #$00
	STA BITLOCO+1
	DEY
	BPL CHECKTURBO
BITLOCO
	LDA #$00
	SEC
	SBC #$9A
	BMI NODIO
	BEQ SIDIO
	BPL NODIO
SIDIO
	JSR $E459
NODIO
	JMP ($0304)
MUS
	LDA #$82
	STA $D203
	DEC SCUIS
	LDA SCUIS
	BNE NO0SCUIS
	LDA #120
	STA SCUIS
NO0SCUIS
	STA $D202
	DEC VOLUME
	LDA VOLUME
	STA $D201
	CMP #$A2
	BNE FINMUS
	LDA #$AA
	STA VOLUME
	INC QUENOTA
	LDX QUENOTA
	LDA TONOS,X
	CMP #$FF
	BNE NOFINMUS
	LDA #23
	STA QUENOTA
	JMP MUS
	NOFINMUS
	STA $D200
FINMUS
	LDA PALNTS
	BEQ FINMUS.FIN
	DEC FINMUS.CONTADOR
	BNE FINMUS.FIN
	LDA #6
	STA FINMUS.CONTADOR
	BNE MUS
FINMUS.FIN
	JMP $E45F
FINMUS.CONTADOR
	.BY 6
VOLUME 	.BY $AA
SCUIS 	.BY 130
QUENOTA .BY 0
TONOS
	.BY 0,0,0,0,0,0,0,0,0,0,0,0
	.BY 0,0,0,0,0,0,0,0,0,0,0,0
	.BY 162,81,81,81,81,81,91,81,81,81,81,81
	.BY 102,81,81,81,81,81,108,81,81,81,81,81
	.BY 121,81,81,81,81,81,121,91,136,102,144,108
	.BY 162,121,144,108,136,102,144,108,162,121,182,136
	.BY 162,121,144,108,136,102,144,108,162,121,182,136
	.BY 204,144,217,162,243,204,243,182,217,162,204,217
	.BY 162,121,144,108,136,102,144,108,162,121,182,136
	.BY 162,121,144,108,136,102,144,108,162,121,182,136
	.BY 108,0,108,108,0,121,0,0,0,0,0,0
	.BY 136,0,136,136,0,144,0,0,0,0,0,0
	.BY 162,0,162,0,162,0,144,0,144,0,144,0
	.BY 136,0,136,0,144,0,162,0,0,0,0,0
	.BY 108,0,108,108,0,121,0,0,0,0,0,0
	.BY 136,0,136,136,0,144,0,0,0,0,0,0
	.BY 162,0,162,0,0,162,144,0,144,0,0,144
	.BY 136,0,136,144,0,162,0,0,0,0,0,0,$FF
DATALAST
	.BY $60
	.BY $00
	.BY $52
	.BY $40
	.WO BLKDOS
	.BY $23
	.BY $00
	.WO FINBLKDOS-BLKDOS
	.BY $00
	.BY $80
DL
	.BY 112,112,112,64+6
CAMBIO1
	.WORD DATA
	.BY 112,112,112,112,112,112,112,112,112,112
	.BY 65
	.WORD DL
DATA
	.SB "   turbo SOFTWARE   "
ROMARAM
	LDA #$40
	PHA
	TAX
	LDA #$00
	PHA
	TAY
	STY ROM
	STY RAM
REENTRE
	STX RAM+1
	LDX #$C0
LOOPCITO
	STX ROM+1
LOOP1
	LDA (ROM),Y
	STA (RAM),Y
	DEY
	BNE LOOP1
	INC RAM+1
	INC ROM+1
	INX
	BEQ ROMOFF
	CPX #$D0
	BNE LOOP1
	LDX #$D8
	BNE LOOPCITO
ROMOFF
	SEI
	PLA
	STA $D40E
;
	LDA $D301
	AND #$FE
	STA $D301
RETURN
	LDA #RAM
	STA LOOP1+1
	LDA #ROM
	STA LOOP1+3
	LDA #$60
	STA ROMOFF+5
	LDA #$58
	STA ROMOFF
	LDX #$40
	JMP REENTRE
FINBLKFALSO
