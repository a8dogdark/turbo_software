0100 ; SAVE#D:TENIS2.MAC
0110     *=  $3000
0120 BLKDOS
0130     .BYTE $55,$55
0140 ORIGEN = $3000
0150 PROGRAMA = $CC00
0160     TYA
0170     BPL BLKOK
0180     JSR $EDC7
0190     JMP $C8FC
0200 BLKOK
0210     LDA EORBLOCK1
0220     EOR #$FF
0230     STA EORBLOCK1
0240     INC BLKOK+6
0250     INC BLKOK+1
0260     BNE NOICRHI
0270     INC BLKOK+7
0280     INC BLKOK+2
0290 NOICRHI
0300     LDA BLKOK+2
0310     CMP # >FINBLKDOS
0320     BNE BLKOK
0330     LDA BLKOK+1
0340     CMP # <FINBLKDOS
0350     BNE BLKOK
0360 EORBLOCK1
0370     LDA $E45A
0380     STA SALTO
0390     LDA $E45B
0400     STA SALTO+1
0410     LDA # <RAMPROG+SET
0420     STA $E45A
0430     STA ROM
0440     LDA # >RAMPROG+SET
0450     STA $E45B
0460     STA ROM+1
0470     LDA # <RAMPROG
0480     STA RAM
0490     LDA # >RAMPROG
0500     STA RAM+1
0510     LDY #0
0520     LDX #3
0530 ARRIBAROM
0540     LDA (RAM),Y
0550     STA (ROM),Y
0560     INY
0570     BNE ARRIBAROM
0580     INC RAM+1
0590     INC ROM+1
0600     DEX
0610     BPL ARRIBAROM
0620     LDX #$02
0630 LOOPINTERRUPCION
0640     LDA JSRINTERRUPCION,X
0650     STA $EB59,X
0660     LDA ERRORYA,X
0670     STA $EB1D,X
0680     DEX
0690     BPL LOOPINTERRUPCION
0700     STX $02DB
0710     STX $03F8
0720     STX $FE0D
0730     LDX $62
0740     LDA #$00
0750     STA $0480
0760     STA $0481
0770     STA $FE91,X
0780     LDA #$32
0790     STA $FE93,X
0800     LDA #$EA
0810     STA $EBF3
0820     STA $EBF4
0830     LDA #$C0
0840     STA $6A
0850     LDA #133
0860     STA $FE48
0870     LDA #12
0880     STA 764
0890     LDX #$40
0900     LDA #$0C
0910     STA $0342,X
0920     JSR $E456
0930     LDX #$40
0940     LDA #$03
0950     STA $0342,X
0960     LDA #$04
0970     STA $034A,X
0980     LDA #$80
0990     STA $034B,X
1000     LDA # <C
1010     STA $0344,X
1020     LDA # >C
1030     STA $0345,X
1040     JSR $E456
1050     LDX #$40
1060     LDA # <GAMEA+Z
1070     STA $0344,X
1080     LDA # >GAMEA+Z
1090     STA $0345,X
1100     LDA # <FIN-GAMEA
1110     STA $0348,X
1120     LDA # >FIN-GAMEA
1130     STA $0349,X
1140     LDA #$07
1150     STA $0342,X
1160     LDA #$F0
1170     STA QUEBLK+SET+1
1180     JSR $E456
1190     JMP GAMEA+Z
1200 C
1210     .BYTE "C:",$9B
1220 JSRINTERRUPCION
1230     JSR INTERRUPCION+SET
1240 ERRORYA
1250     JSR ERROR?+SET
1260 RAMPROG
1270     LDA $0300
1280     CMP #$60
1290     BNE READBLOCK
1300 NEXT
1310     JSR READBLOCK+SET
1320     BMI ERROR
1330 VUELTABLK1
1340     LDA $0480
1350     STA QUEBLK+SET
1360     LDA $0481
1370     STA QUEBLK+SET+1
1380     LDX #$02
1390 COUNTBLOCK
1400     DEC BLK+SET,X
1410     LDA BLK+SET,X
1420     CMP #'0-33
1430     BNE FINCOUNT
1440     LDA #'9-32
1450     STA BLK+SET,X
1460     DEX
1470     BPL COUNTBLOCK
1480 FINCOUNT
1490     LDY #$01
1500     RTS
1510 READBLOCK
1520     JMP (SALTO+SET)
1530 ERROR?
1540     BEQ ERRORAZO
1550     LDY $30
1560     BMI ERRORAZO
1570     LDA $0317
1580     BEQ ERRORAZO
1590     RTS
1600 ERRORAZO
1610     PLA
1620     PLA
1630 ERROR
1640     JSR $EDC7
1650     CPY #136
1660     BNE NOESEOF
1670     TYA
1680     RTS
1690 NOESEOF
1700     LDX #$0A
1710 LOOPCORRIGIENDO
1720     LDA CORRECCION+SET,X
1730     STA LEYENDO+SET,X
1740     DEX
1750     BPL LOOPCORRIGIENDO
1760     CLC
1770     LDA 560
1780     STA $00
1790     LDA 561
1800     STA $01
1810     LDY #$0A
1820 SAVEVIEJO
1830     LDA ($00),Y
1840     PHA
1850     INY
1860     CPY #$0D
1870     BNE SAVEVIEJO
1880 JUSTO
1890     LDA $D40B
1900     BMI JUSTO
1910     LDY #$0A
1920     LDA #$01
1930     STA ($00),Y
1940     LDA 561
1950     CMP # >DISPLIST+SET
1960     BNE NOTENNIS
1970     LDA # <DL1+SET
1980     LDX # >DL1+SET
1990     BNE SITENNIS
2000 NOTENNIS
2010     LDA # <DL2+SET
2020     LDX # >DL2+SET
2030 SITENNIS
2040     INY
2050     STA ($00),Y
2060     TXA
2070     INY
2080     STA ($00),Y
2090     JSR $F2F8
2100 JUSTO1
2110     LDA $D40B
2120     BMI JUSTO1
2130     LDY #$0C
2140 RESTAURA
2150     PLA
2160     STA ($00),Y
2170     DEY
2180     CPY #$09
2190     BNE RESTAURA
2200     LDA #$34
2210     STA $D302
2220     LDA $14
2230     CLC
2240     ADC #50
2250 WMOTOR
2260     CMP $14
2270     BNE WMOTOR
2280 ESPERE
2290     LDY $D40B
2300     LDX #$05
2310 ESPERE1
2320     STX $D40A
2330 ESIRG
2340     LDA $D20F
2350     AND #$10
2360     BEQ ESPERE
2370     CPY $D40B
2380     BNE ESIRG
2390     DEX
2400     BNE ESPERE1
2410 NOESIGUAL
2420     LDA #$40
2430     STA $0303
2440     JSR READBLOCK+SET
2450     BPL NOERRORFALSO
2460     JSR $EDC7
2470     LDA #$34
2480     STA $D302
2490     BNE ESPERE
2500 NOERRORFALSO
2510     LDA QUEBLK+SET+1
2520     BPL NOBLK1
2530     LDA $0480
2540     ORA $0481
2550     BNE VALLAERROR
2560     JSR CHANGEMSG+SET
2570     JMP VUELTABLK1+SET
2580 CHANGEMSG
2590     LDX #$0A
2600 LOOPLECTURA
2610     LDA LECTURA+SET,X
2620     STA LEYENDO+SET,X
2630     DEX
2640     BPL LOOPLECTURA
2650     LDY #$01
2660     RTS
2670 NOBLK1
2680     LDX #$01
2690 LOOPLUGAR
2700     LDA $0480,X
2710     CMP QUEBLK+SET,X
2720     BCC NOESIGUAL
2730     BNE VALLAERROR
2740     DEX
2750     BPL LOOPLUGAR
2760     JSR CHANGEMSG+SET
2770     JMP NEXT+SET
2780 VALLAERROR
2790     JMP ERROR+SET
2800 INTERRUPCION
2810     LDA LEYENDO+SET
2820     AND #$7F
2830     BEQ BYTESLOOP
2840     BNE NOES9I
2850 BYTESLOOP
2860     LDX #$04
2870 BYTESLOOP1
2880     INC BYTES+SET,X
2890     LDA BYTES+SET,X
2900     CMP #'9-31
2910     BNE NOES9I
2920     LDA #'0-32
2930     STA BYTES+SET,X
2940     DEX
2950     BPL BYTESLOOP1
2960 NOES9I
2970     LDA $D20D
2980     RTS
2990 SALTO .DBYTE 0
3000 QUEBLK .DBYTE 0
3010 TENMEBLK
3020     .BYTE "000"
3030 MENSAJEERROR
3040     .SBYTE "   REBOBINE SU CASSETTE
 3 VUELTAS DE    "
3050     .SBYTE "   CONTADOR, PRESIONE ?
PLAY?Y?RETURN?   "
3060 PANTALLA
3070     .BYTE "********************"
3080 PERS .SBYTE "  "
3090 NUMERO1 .SBYTE "000"
3100     .SBYTE "     * 1 JUGADOR-FRONTO
N *    "
3110 NUMERO2 .SBYTE "000  "
3120 MENSAJE
3130     .SBYTE "  MPM    * CARGANDO  PR
OGRAMA *    MPM  "
3140     .SBYTE "  "
3150 LEYENDO
3160     .SBYTE " (R)-1988   BYTES:"
3170 BYTES
3180     .SBYTE "00000  BLOQUE:"
3190 BLK
3200     .SBYTE "000   "
3210     .BYTE "********************"
3220 PER2
3230     .SBYTE "  000     * 2 JUGADORES
-TENIS *    000  "
3240 PER1
3250     .SBYTE "  000     * 1 JUGADOR-F
RONTON *    000  "
3260 CORRECCION
3270     .SBYTE "CORRECCION"
3280 LECTURA
3290     .SBYTE " (R)-1988 "
3300 CARGADO
3310     .SBYTE "    PROGRAMA CARGADO, P
RESIONE START    "
3320 DL2
3330     .BYTE 64+2
3340     .WORD MENSAJEERROR+SET
3350     .BYTE 2,65
3360     .WORD $BC20
3370 DL1
3380     .BYTE 64+2
3390     .WORD MENSAJEERROR+SET
3400     .BYTE 2,112,112,112,112,112,112
,112,112,112,112,112,112,112,112,112,112

3410     .BYTE 64+2
3420     .WORD MENSAJE+SET
3430     .BYTE 2,8,8
3440     .BYTE 65
3450     .WORD DISPLIST+SET
3460 DISPLIST
3470     .BYTE 64+8
3480     .WORD PANTALLA+SET
3490     .BYTE 8,2,112,112,112,112,112,1
12,112
3500 AQUIJUMP
3510     .BYTE 112,112,112,112,112,112,1
12,112,112,112,112,112,112,112,112,112,0

3520     .BYTE 64+2
3530 CUALPANTALLA
3540     .WORD MENSAJE+SET
3550     .BYTE 2,8,8
3560     .BYTE 65
3570     .WORD DISPLIST+SET
3580 BUFFER
3590 FINBLKDOS
3600     *=  $4000
3610 GAMEA
3620 Z   =   $D800-*
3630     LDA # <GAME1A+Z
3640     STA $CB
3650     LDA # >GAME1A+Z
3660     STA $CC
3670     LDY #$00
3680 EOR29LOOP
3690     LDA ($CB),Y
3700     EOR #$29
3710     STA ($CB),Y
3720     INC $CB
3730     BNE BCC
3740     INC $CC
3750 BCC
3760     LDA $CC
3770     CMP # >FIN+Z
3780     BNE EOR29LOOP
3790     LDA $CB
3800     CMP # <FIN+Z
3810     BNE EOR29LOOP
3820 GAME1A
3830     JMP COMIENZOLOAD+Z
3840 SETCANT
3850     LDX #$10
3860     STA $0348,X
3870     TYA
3880     STA $0349,X
3890     RTS
3900 READ2
3910     LDA #$02
3920     LDY #$00
3930     JSR SETCANT+Z
3940 READ3
3950     LDA # <FIN+Z
3960     LDY # >FIN+Z
3970 SETPOS
3980     STA $0344,X
3990     TYA
4000     STA $0345,X
4010     LDA #$07
4020     STA $0342,X
4030     JSR $E456
4040     BPL NOEOF
4050     JMP INICIOBOOT+Z
4060 NOEOF
4070     LDX #$10
4080     RTS
4090 BYTELENTO .BYTE $00
4100 LEEMULA
4110     LDA #$01
4120     STA BYTELENTO+Z
4130 LEEMULA1
4140     LDA $D20F
4150     AND #$10
4160     BEQ LEEMULA1
4170 FINSTART
4180     LDA $D20F
4190     AND #$10
4200     BNE FINSTART
4210 ;   LDA #$00-12
4211     LDA #$00-10
4220     STA 20
4230 ESPERO12
4240     LDA 20
4250     BNE ESPERO12
4260 LEOBIT
4270     CLC
4280     LDA $D20F
4290     AND #$10
4300     BEQ LEICERO
4310     SEC
4320 LEICERO
4330     ROL BYTELENTO+Z
4340     BCS FINBYTELENTO
4350 ;   LDA #$00-8
4351     LDA #$00-7
4360     STA 20
4370     BNE ESPERO12
4380 FINBYTELENTO
4390     LDA BYTELENTO+Z
4400     RTS
4410 COMIENZOLOAD
4420     LDY $D40B
4430     BMI COMIENZOLOAD
4440     LDA # <$E45F
4450     STA $0222
4460     LDA # >$E45F
4470     STA $0223
4480     LDA #$00
4490     STA $D200
4500     STA $D201
4510     STA $D202
4520 BORRAMEM
4530     LDA #$04
4540     STA $01
4550     LDA #$00
4560     STA $00
4570     TAY
4580 ERASERAM
4590     STA ($00),Y
4600     INY
4610     BNE ERASERAM
4620     INC $01
4630     LDX $01
4640 PONERC0
4650     CPX #$C0
4660     BNE ERASERAM
4670     LDX #$02
4680 ZLOOPCEROS
4690     LDA TENMEBLK+SET,X
4700     STA BLK+SET,X
4710     LDA #'0-32
4720     STA BYTES+2+SET,X
4730     DEX
4740     BPL ZLOOPCEROS
4750     STA BYTES+1+SET
4760     LDX #$03
4770     LDA #$00
4780 NIRUNNISTART
4790     STA $02E0,X
4800     DEX
4810     BPL NIRUNNISTART
4820     STA FBOOT+Z
4830 PMBASE = $DC
4840 JOYST = $D300
4850 BOTON1 = $D010
4860 BOTON2 = $D011
4870 COLORP0 = $02C0
4880 HPOSP0 = $D000
4890 HPOSP1 = $D001
4900 HPOSP2 = $D002
4910 DIVISION = $D007
4920 CONSOL = $D01F
4930 RANDOM = $D20A
4940 BOLITA = PMBASE*$0100+768+16
4950 P0  =   PMBASE*$0100+512+16
4960 P1  =   PMBASE*$0100+640+16
4970 INICIO
4980     LDY #17
4990     LDA #$EA
5000 NOPDLIVBI
5010     STA $C137,Y
5020     DEY
5030     BPL NOPDLIVBI
5040     LDY #$02
5050 NOSHADOWS
5060     STA $C16F,Y
5070     STA $C178,Y
5080     DEY
5090     BPL NOSHADOWS
5100     LDA #0
5110     STA START+Z
5120     LDX #$82
5130 LOOPCLR
5140     STA BOLITA,X
5150     STA P0-2,X
5160     STA P1-2,X
5170     DEX
5180     CPX #$FF
5190     BNE LOOPCLR
5200     INX
5210 LOOPCLR1
5220     STA $DE00,X
5230     STA $DF00,X
5240     DEX
5250     BNE LOOPCLR1
5260     LDA #191
5270     STA HPOSP0
5280     LDA #0
5290     STA HPOSP1
5300     LDA #191
5310     STA HPOSP2
5320     LDX #42
5330     STX $D004
5340     LDX #206
5350     STX $D005
5360     JSR SETPERS+Z
5370     LDA #63
5380     STA $D00C
5390     LDA #$03
5400     LDX YPOS0+Z
5410     LDY #$0C
5420 DIBP1
5430     STA P0,X
5440     STA P1,X
5450     INX
5460     DEY
5470     BPL DIBP1
5480     LDA #1
5490     LDX YPOS2+Z
5500     STA BOLITA,X
5510 WFORSET
5520     LDA $D40B
5530     BMI WFORSET
5540     LDA # <VBI+Z
5550     STA $0222
5560     LDA # >VBI+Z
5570     STA $0223
5580     JMP OPEN+Z
5590 SETPERS
5600     LDA #2
5610     STA 623
5620     STA $D01D
5630     LDA #PMBASE
5640     STA $D407
5650     LDX #0
5660     STX DIVISION
5670     LDA #$7F
5680     STA $D011
5690     RTS
5700 YPOS0 .BYTE 48
5710 YPOS1 .BYTE 48
5720 YPOS2 .BYTE 48
5730 XPOS2 .BYTE 191
5740 XPOS1 .BYTE 0
5750 FX  .BYTE $FF
5760 FY  .BYTE 0
5770 START .BYTE 0
5780 IMPULSO .BYTE 0
5790 SELECT .BYTE 0
5800 JUEGO .BYTE $FF
5810 SAVEVBI .DBYTE 0
5820 VBI
5830     LDA # >DISPLIST+SET
5840     STA $D403
5850     STA $0244
5860     STA 561
5870     LDA # <DISPLIST+SET
5880     STA $D402
5890     STA 560
5900     LDA #0
5910     STA 77
5920     STA $D018
5930     LDA #$E0
5940     STA $D409
5950     LDA #$0E
5960     STA $D012
5970     STA $D013
5980     STA $D014
5990     STA $D016
6000     STA $D017
6010     STA $D019
6020     LDA #212
6030     STA $D01A
6040     LDA #42
6050     STA $D400
6060     LDA #$A0
6070     STA $D201
6080     LDA #$00
6090     STA $D200
6100     LDA CONSOL
6110     CMP #$05
6120     BNE SELECT0
6130     LDA SELECT+Z
6140     BNE NOCAMBIO
6150     LDA #1
6160     STA SELECT+Z
6170     LDA #0
6180     STA START+Z
6190     LDY #39
6200     LDA JUEGO+Z
6210     EOR #$FF
6220     STA JUEGO+Z
6230     BMI ESUNO
6240 CHANGE ;        2 PERS
6250     LDA PER2+SET,Y
6260     STA PERS+SET,Y
6270     DEY
6280     BPL CHANGE
6290     LDA #50
6300     STA HPOSP1
6310     STA XPOS1+Z
6320     LDA #127
6330     STA DIVISION
6340     BNE TERMINELO
6350 ESUNO ;         1PER
6360     LDA PER1+SET,Y
6370     STA PERS+SET,Y
6380     DEY
6390     BPL ESUNO
6400     LDA #0
6410     STA HPOSP1
6420     STA XPOS1+Z
6430     STA DIVISION
6440 TERMINELO
6450     JMP $E45F
6460 SELECT0
6470     LDA #0
6480     STA SELECT+Z
6490 NOCAMBIO
6500     LDA START+Z
6510     BNE STARTED
6520     LDA #0
6530     LDX YPOS2+Z
6540     STA BOLITA,X
6550     LDA CONSOL
6560     CMP #$06
6570     BNE NOSTART
6580     LDA #$FF
6590     STA START+Z
6600 NOSTART
6610     LDA XPOS2+Z
6620     BPL BOTON2?
6630     LDA BOTON1
6640     BNE JOY
6650     LDA YPOS0+Z
6660     STA YPOS2+Z
6670     LDA #190
6680     STA XPOS2+Z
6690 EMPIEZELO
6700     LDA #$FF
6710     STA START+Z
6720     BNE TERMINELO
6730 BOTON2?
6740     LDA BOTON2
6750     BNE JOY
6760     LDA YPOS1+Z
6770     STA YPOS2+Z
6780     LDA #51
6790     STA XPOS2+Z
6800     BNE EMPIEZELO
6810 JOY
6820     JMP JOYSTS+Z
6830 STARTED
6840     LDA FX+Z
6850     BPL INCRX
6860     JSR DECREX+Z
6870     JMP UD+Z
6880 INCRX
6890     JSR INCREX+Z
6900 UD
6910     LDA #0
6920     LDX YPOS2+Z
6930     STA BOLITA,X
6940     LDA FY+Z
6950     BPL INCRY
6960     JSR DECREY+Z
6970     JMP JOYSTS+Z
6980 INCRY
6990     JSR INCREY+Z
7000     JMP JOYSTS+Z
7010 DECREX
7020     LDA $D00E
7030     AND #$02
7040     BEQ NOREBOTE
7050     LDA #$33
7060     STA $D200
7070     LDA #$AC
7080     STA $D201
7090     LDA JOYST
7100     LSR A
7110     LSR A
7120     LSR A
7130     LSR A
7140     CMP #$0F
7150     BEQ NOIMPULSE1
7160     LDA #$FF
7170 NOIMPULSE1
7180     STA IMPULSO+Z
7190     LDX XPOS2+Z
7200     JMP CHANGEXF+Z
7210 NOREBOTE
7220     DEC XPOS2+Z
7230     DEC XPOS2+Z
7240     LDX XPOS2+Z
7250     CPX #45
7260     BCS FINDECREX
7270     LDA XPOS1+Z
7280     CMP #40
7290     BCC OUT2
7300     LDA #0
7310     STA START+Z
7320 OUT2
7330     LDA #$88
7340     STA $D200
7350     LDA #$AC
7360     STA $D201
7370     LDY #2
7380 ZERO1
7390     LDA NUMERO1+SET,Y
7400     CMP #'9-32+128
7410     BEQ NINE1
7420     CLC
7430     ADC #1
7440     STA NUMERO1+SET,Y
7450     BNE CHANGEXF
7460 NINE1
7470     LDA #'0+128-32
7480     STA NUMERO1+SET,Y
7490     DEY
7500     BPL ZERO1
7510 CHANGEXF
7520     LDA FX+Z
7530     EOR #$FF
7540     STA FX+Z
7550 FINDECREX
7560     STX XPOS2+Z
7570     STX HPOSP2
7580     RTS
7590 INCREX
7600     LDA $D00E
7610     AND #$01
7620     BEQ NOREBOTE1
7630     LDA #$AC
7640     STA $D201
7650     LDA #$33
7660     STA $D200
7670     LDA JOYST
7680     AND #$0F
7690     CMP #$0F
7700     BEQ NOIMPULSE
7710     LDA #$FF
7720 NOIMPULSE
7730     STA IMPULSO+Z
7740     LDX XPOS2+Z
7750     JMP CHANGEXF+Z
7760 NOREBOTE1
7770     INC XPOS2+Z
7780     INC XPOS2+Z
7790     LDX XPOS2+Z
7800     CPX #205
7810     BCC FINDECREX
7820 SELEFUE
7830     LDA #0
7840     STA START+Z
7850     LDA #$88
7860     STA $D200
7870     LDA #$AC
7880     STA $D201
7890     LDY #2
7900 ZERO2
7910     LDA NUMERO2+SET,Y
7920     CMP #'9-32+128
7930     BEQ NINE2
7940     CLC
7950     ADC #1
7960     STA NUMERO2+SET,Y
7970     BNE CHANGEXF
7980 NINE2
7990     LDA #'0+128-32
8000     STA NUMERO2+SET,Y
8010     DEY
8020     BPL ZERO2
8030     BMI CHANGEXF
8040 INCREY
8050     INC YPOS2+Z
8060     LDA IMPULSO+Z
8070     BPL BOTAR1
8080     INC YPOS2+Z
8090 BOTAR1
8100     LDX YPOS2+Z
8110     CPX #92
8120     BCC FININCRY
8130 CHANGEFY
8140     LDA FY+Z
8150     EOR #$FF
8160     STA FY+Z
8170     LDA #$50
8180     STA $D200
8190     LDA #$AC
8200     STA $D201
8210 FININCRY
8220     LDA #1
8230     STA BOLITA,X
8240     RTS
8250 DECREY
8260     DEC YPOS2+Z
8270     LDA IMPULSO+Z
8280     BPL BOTAR2
8290     DEC YPOS2+Z
8300 BOTAR2
8310     LDX YPOS2+Z
8320     BMI CHANGEFY
8330     BPL FININCRY
8340 JOYSTS
8350     LDA #0
8360     STA $D01E
8370     LDA JOYST
8380     AND #$0F
8390     CMP #15
8400     BEQ JOY2
8410     CMP #14
8420     BNE DWN1
8430     JSR J1UP+Z
8440     JMP JOY2+Z
8450 DWN1
8460     CMP #13
8470     BNE JOY2
8480     JSR J1DWN+Z
8490 JOY2
8500     LDA JOYST
8510     LSR A
8520     LSR A
8530     LSR A
8540     LSR A
8550     CMP #15
8560     BEQ EXIT
8570     CMP #14
8580     BNE DWN2
8590     JSR J2UP+Z
8600     JMP $E45F
8610 DWN2
8620     CMP #13
8630     BNE EXIT
8640     JSR J2DWN+Z
8650 EXIT
8660     JMP $E45F
8670 J1UP
8680     LDY YPOS0+Z
8690     BEQ FINJ1UP
8700     LDX #16
8710 LOOPJ1UP
8720     LDA P0,Y
8730     STA P0-2,Y
8740     INY
8750     DEX
8760     BPL LOOPJ1UP
8770     DEC YPOS0+Z
8780     DEC YPOS0+Z
8790 FINJ1UP
8800     RTS
8810 J2UP
8820     LDY YPOS1+Z
8830     BEQ FINJ2UP
8840     LDX #16
8850 LOOPJ2UP
8860     LDA P1,Y
8870     STA P1-2,Y
8880     INY
8890     DEX
8900     BPL LOOPJ2UP
8910     DEC YPOS1+Z
8920     DEC YPOS1+Z
8930 FINJ2UP
8940     RTS
8950 J1DWN
8960     LDY YPOS0+Z
8970     CPY #80
8980     BEQ FINJ1DWN
8990     TYA
9000     CLC
9010     ADC #14
9020     TAY
9030     LDX #16
9040 LOOPJ1DWN
9050     LDA P0-2,Y
9060     STA P0,Y
9070     DEY
9080     DEX
9090     BPL LOOPJ1DWN
9100     INC YPOS0+Z
9110     INC YPOS0+Z
9120 FINJ1DWN
9130     RTS
9140 J2DWN
9150     LDY YPOS1+Z
9160     CPY #80
9170     BEQ FINJ2DWN
9180     TYA
9190     CLC
9200     ADC #14
9210     TAY
9220     LDX #16
9230 LOOPJ2DWN
9240     LDA P1-2,Y
9250     STA P1,Y
9260     DEY
9270     DEX
9280     BPL LOOPJ2DWN
9290     INC YPOS1+Z
9300     INC YPOS1+Z
9310 FINJ2DWN
9320     RTS
9330 OPEN
9340     LDA #$FF
9350     STA $0340
9360     LDX #$10
9370     LDA #$03
9380     STA $0342,X
9390     LDA # <DEVICE+Z
9400     STA $0344,X
9410     LDA # >DEVICE+Z
9420     STA $0345,X
9430     LDA #$04
9440     STA $034A,X
9450     LDA #$80
9460     STA $034B,X
9470     LDA #$0C
9480     STA 764
9490     JSR $E456
9500 ZREAD
9510     JSR READ2+Z
9520     LDA FIN+Z
9530     AND FIN+1+Z
9540     CMP #$FF
9550     BNE SERABOOT?
9560     LDA # <$E474-1
9570     STA $0C
9580     LDA # >$E474-1
9590     STA $0D
9600     LDA #$01
9610     STA FBOOT+Z
9620     BNE ZREAD
9630 SERABOOT?
9640     LDA $02E0
9650     ORA $02E1
9660     BNE RUNOK
9670     LDA FIN+Z
9680     STA $02E0
9690     LDA FIN+1+Z
9700     STA $02E1
9710 RUNOK
9720     LDA FBOOT+Z
9730     BNE NOESBOOT
9740     JMP ESBOOT+Z
9750 NOESBOOT
9760     LDA FIN+Z
9770     STA $0240
9780     LDA FIN+1+Z
9790     STA $0241
9800     JSR READ2+Z
9810     SEC
9820     LDA FIN+Z
9830     SBC $0240
9840     STA $0348,X
9850     LDA FIN+1+Z
9860     SBC $0241
9870     STA $0349,X
9880     INC $0348,X
9890     BNE NOCARRYY
9900     INC $0349,X
9910 NOCARRYY
9920     LDA $0240
9930     LDY $0241
9940     JSR SETPOS+Z
9950     LDA $02E2
9960     ORA $02E3
9970     BEQ NOSUBRUTIN
9980 CONSUBRUTINA
9990     JSR USERSUB+Z
010000   LDA #$00
010010   STA $02E2
010020   STA $02E3
010030 NOSUBRUTIN
010040   JMP ZREAD+Z
010050 USERSUB
010060   JMP ($02E2)
010070 CORREPROGRAMA
010080   LDA #$FF
010090   STA $D301
010100   JMP ($02E0)
010110 INICIOBOOT
010120   LDA #$00-30
010130   STA 20
010140 WRELOS
010150   LDA $D20F
010160   AND #$10
010170   BEQ INICIOBOOT
010180   LDA 20
010190   BNE WRELOS
010200   LDY #$02
010210 LEOLENTO
010220   JSR LEEMULA+Z
010230   STA $03E0,Y
010240   DEY
010250   BPL LEOLENTO
010260   LDA $03E0
010270   CMP $03E2
010280   BEQ JUSTOAHORA
010290   CMP $03E1
010300   BEQ JUSTOAHORA
010310   LDA $03E2
010320   CMP $03E1
010330   BEQ JUSTOAHORA
010340 LEYODISTINTO
010350   LDA #$03
010360   STA PONERC0+Z+1
010370   JMP BORRAMEM+Z
010380 JUSTOAHORA
010390   LDA #$3C
010400   STA $D302
010410   LDX #39
010420 PROGRAMAENMEMORIA
010430   LDA CARGADO+SET,X
010440   STA MENSAJE+SET,X
010450   DEX
010460   BPL PROGRAMAENMEMORIA
010470 PRESIONOCAMBIO?
010480   LDA CONSOL
010490   CMP #$06
010500   BNE PRESIONOCAMBIO?
010501 PRESIONOCAMBIO?2
010502   LDA CONSOL
010503   CMP #$07
010504   BNE PRESIONOCAMBIO?2
010505 ; SUELTA START ANTES DE EMPEZAR
010506 ;
010507 ;
010508 ;
010509 ;
010510   LDX #$07
010520 LLEVARAM
010530   LDA CORREPROGRAMA+Z,X
010540   STA $0392,X
010550   DEX
010560   BPL LLEVARAM
010570 JUSTO2
010580   LDA $D40B
010590   BMI JUSTO2
010600   LDA # <$E45F
010610   STA $0222
010620   LDA # >$E45F
010630   STA $0223
010640   LDA #$00
010650   STA 623
010660   LDX #$1F
010670 PMARGEN
010680   STA $D000,X
010690   DEX
010700   BPL PMARGEN
010710   LDA #$00
010720   STA $0244
010730   LDA #$02
010740   STA $09
010750   LDA $02E0
010760   STA $02
010770   STA $0A
010780   LDA $02E1
010790   STA $03
010800   STA $0B
010810   LDA $0D
010820   PHA
010830   LDA $0C
010840   PHA
010850 SINRESET
010860   JMP $0392
010870 ESBOOT
010880   LDA FIN+Z
010890   STA $0240
010900   LDA FIN+1+Z
010910   STA $0241
010920   JSR READ2+Z
010930   CLC
010940   LDA FIN+Z
010950   ADC #$06
010960   STA $04
010970   LDA FIN+1+Z
010980   ADC #$00
010990   STA $05
011000   JSR READ2+Z
011010   LDA FIN+Z
011020   STA $0C
011030   LDA FIN+1+Z
011040   STA $0D
011050   LDY #$06
011060 MULTIPLICA
011070   ASL $0241
011080   ROL $0240
011090   DEY
011100   BPL MULTIPLICA
011110   LDA $0240
011120   STA $0349,X
011130   LDA $0241
011140   STA $0348,X
011150   LDA $04
011160   STA $0344,X
011170   STA $02E0
011180   LDA $05
011190   STA $0345,X
011200   STA $02E1
011210   LDA #$07
011220   STA $0342,X
011230   JSR $E456
011240   SEC
011250   LDA $0C
011260   SBC #$01
011270   STA $0C
011280   LDA $0D
011290   SBC #$00
011300   STA $0D
011310   JMP INICIOBOOT+Z
011320 FBOOT
011330   .BYTE 0
011340 DEVICE
011350   .BYTE "C:",$9B
011360 FIN
011370   .END
